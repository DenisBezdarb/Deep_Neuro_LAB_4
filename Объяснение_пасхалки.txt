Код реализует линейную регрессию с использованием метода наименьших квадратов.

X = np.hstack([np.ones((X.shape[0], 1)), df.iloc[:, [0]].values]) # Подготовка данных
Добавляется столбец из единиц к признакам, а также используется только первый признак

y = df.iloc[:, -1].values # Извлечение целевой переменной

w = np.linalg.inv(X.T @ X) @ X.T @ y # Вычисление весов модели
Это аналитическое решение метода наименьших квадратов. Формула: w = ((X^T)y)/((X^T)X)
где X.T @ X — ковариационная матрица
np.linalg.inv — обратная матрица
результат w — вектор коэффициентов линейной регрессии

predicted = X @ w # Умножение матрицы признаков X на вектор весов w дает предсказанные значения

print(predicted)